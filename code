import os
import subprocess
import time
from pywinauto import Application

working_directory = r"C:\Users\jainnbr\AppData\Local\Microsoft\AppV\Client\Integration\69A67715-479F-47AC-AF29-2CB913A54A51\Root\VFS\ProgramFilesX64\ITRSGroup\Geneos Active Console"
exe_path = "ActiveConsole.exe"
full_exe_path = os.path.join(working_directory, exe_path)

# Run the .exe file with the specified working directory
subprocess.Popen([full_exe_path], cwd=working_directory)

# Sleep time for opening the application
time.sleep(20)

# Use pywinauto to attach to the application window
app = Application(backend="uia").connect(path=full_exe_path)

# Specify the button's text you want to click
button_text = "UAT"

try:
    # Find the specific window by its title
    specific_window_title = "Active Dashboard Manager"
    specific_window = app.window(title=specific_window_title)

    # Activate the specific window
    specific_window.set_focus()

    # Maximize the specific window
    specific_window.maximize()

    # Find the button element by its text and click it
    button_element = specific_window.child_window(title=button_text, control_type="Button")
    if button_element.exists():
        button_element.click_input()
    else:
        print(f"Button with text '{button_text}' not found.")
except Exception as e:
    print(f"Error: {e}")
