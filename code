import pandas as pd
import matplotlib.pyplot as plt

# Load the Excel file into a pandas DataFrame
df = pd.read_excel('C:\\Users\\jainnbr\\Latest_SIT_CASe_Mapping.xlsx')

# Bar 1: Total 'No' count for 'descoped'
bar1_data = df['Descoped'].value_counts().get('No', 0)

# Bar 2: 'Golden input' is 'Yes' when 'descoped' is 'No'
bar2_data = df[df['Descoped'] == 'No']['Found In Golden Input'].value_counts().get('Yes', 0)

# Bar 3: 'Augmented' is 'Yes' when both 'descoped' and 'golden input' are 'No'
bar3_data = df[(df['Descoped'] == 'No') & (df['Found In Golden Input'] == 'No')]['Augmented'].value_counts().get('Yes', 0)

# Bar 4: Total of Bar 2 and Bar 3
bar4_data = bar2_data + bar3_data

# Bar 5: Percentage of 'descoped' (Bar 1) compared to total (Bar 4)
bar5_data = (bar1_data / bar4_data) * 100 if bar4_data > 0 else 0

# Plotting the bar chart
bars = ['Total SIT', 'Found In Golden Input Data', 'Total augmented cases in SIT  file', 'Total covered Scenario', 'Total Coverage in Percentage']
values = [bar1_data, bar2_data, bar3_data, bar4_data, bar5_data]

plt.bar(bars, values)
plt.title('Bar Chart Based on Conditions')
plt.ylabel('Count or Percentage')
plt.show()
