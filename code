import pandas as pd
import numpy as np
from itertools import combinations

# Load the CSV file into a pandas DataFrame
df = pd.read_csv('C:\\Users\\jainnbr\\TNTR_trade_SystemX_MAS_FromGoLive.csv')

# Convert all specified date columns to datetime objects
date_columns = ['nonReportableData.maturityDate', 'nonReportableData.startDate', 'reportableData.expirationDate', 'reportableData.settlementDate', 'reportableData.terminationDate']

for col in date_columns:
    df[col] = pd.to_datetime(df[col])

# Create new columns for all permutations of date column comparisons
for col1, col2 in combinations(date_columns, 2):
    new_col_name = f'{col1}_vs_{col2}'
    df[new_col_name] = np.select(
        [df[col1] > df[col2], df[col1] < df[col2]],
        [f'greater', f'lesser'],
        default=f'same'
    )


# Save the updated DataFrame to a new CSV file
df.to_csv('C:\\Users\\jainnbr\\output_file.csv', index=False)
print("File saved successfully")
