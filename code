import os
import subprocess
import time
import pygetwindow as gw
from pywinauto import Application, findwindows
from pywinauto.keyboard import *

working_directory = r"C:\Users\jainnbr\AppData\Local\Microsoft\AppV\Client\Integration\69A67715-479F-47AC-AF29-2CB913A54A51\Root\VFS\ProgramFilesX64\ITRSGroup\Geneos Active Console"
exe_path = "ActiveConsole.exe"
full_exe_path = os.path.join(working_directory, exe_path)

# Run the .exe file with the specified working directory
subprocess.Popen([full_exe_path], cwd=working_directory)

# Sleep time for opening the application
time.sleep(20)

# Use pywinauto to attach to the application window
app = Application(backend="uia").connect(path=full_exe_path)

# Specify the button's text you want to click
button_text = "UAT"

# Find the specific window by its title
specific_window_title = "Active Dashboard Manager"
specific_window = gw.getWindowsWithTitle(specific_window_title)

if specific_window:
        specific_window = specific_window[0]  # Get the specific window object
        specific_window.activate()
        specific_window.maximize()  # Maximize the window
        
        time.sleep(5)

        # Find the button element by its text and click it
        specific_window.window(title=button_text).click_input()
        
else:
        print("Specific window not found.")
