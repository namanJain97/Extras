from openpyxl import load_workbook

def get_cell_color(cell):
    return cell.fill.start_color.rgb if (cell.fill and cell.fill.start_color) else None

def count_rows_by_color(excel_file, sheet_name, column_index):
    # Load the Excel workbook
    workbook = load_workbook(excel_file)

    # Select the sheet
    sheet = workbook[sheet_name]

    # Get the background color of each cell and count occurrences
    color_counts = {}
    for row_index in range(1, sheet.max_row + 1):
        cell = sheet.cell(row=row_index, column=column_index)
        cell_color = get_cell_color(cell)
        color_key = str(cell_color) if cell_color else "None"
        color_counts[color_key] = color_counts.get(color_key, 0) + 1

    return color_counts

# Example usage
excel_file_path ='Copy of MAS_E2E_PabFX_TestScript_V0.2 (003)_final.xlsx'
selected_sheet_name = 'FX FWD'  # Replace with your sheet name
selected_column_index = 1  # Replace with your column index

result = count_rows_by_color(excel_file_path, selected_sheet_name, selected_column_index)
print(result)
