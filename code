package com.rbs.tntr.business.taggingService.configuration;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import com.rbs.ignite.security.auth.AuthenticationService;
import com.rbs.ignite.security.domain.TokenInfo;

@Component
public class TaggingAuthenticationService implements AuthenticationService {

    final SsoConfiguration ssoConfiguration;
    final  AuthenticationService authenticationService;

    @Autowired
    public TaggingAuthenticationService(
            SsoConfiguration ssoConfiguration,
            AuthenticationService authenticationService1) {
        this.ssoConfiguration = ssoConfiguration;
        this.authenticationService = authenticationService1;
    }

    @Override
    public String authenticate(String userName, String password, String permission) {
        return  authenticationService.authenticate(userName,password,permission);
    }

    @Override
    public boolean isTokenValid(String token, String permission) {
        return authenticationService.isTokenValid(token,permission);
    }

    @Override
    public TokenInfo getTokenInfo(String token) {
        return  authenticationService.getTokenInfo(token);
    }

    public String getApplicationSsoToken(){
        return  authenticate(
                ssoConfiguration.getAppUserSsoLogin(),
                ssoConfiguration.getAppUserSsoPwd(),
                ssoConfiguration.getApplicationName()
                );
    }
    public String getApplicationSsoToken(String permission){
        return  authenticate(
                ssoConfiguration.getAppUserSsoLogin(),
                ssoConfiguration.getAppUserSsoPwd(),
                permission
        );

    }
}
