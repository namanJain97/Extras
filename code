import pandas as pd
sit = pd.read_excel('SITMapping_colored.xlsx')
golden = pd.read_excel('GoldenInput_mod_COLORED.xlsx')
count=0
for index_a, row_a in sit.iterrows():
    
    trans_id = row_a["subjectIdentifier.transactionId"]
    trade_version_a = row_a["subjectIdentifier.version"]
    # last_acked = row_a ["nonReportableData.isLastAcked"]
    # lat_version = row_a["nonReportableData.isLatestVersion"]
    
    count+=1
    matching_rows_transId = golden[golden["subjectIdentifier.transactionId"]== trans_id]
    matching_rows_trade_version = matching_rows_transId[matching_rows_transId["subjectIdentifier.version"]==trade_version_a]
    # matching_rows_acked= matching_rows_trade_version[matching_rows_trade_version["nonReportableData.isLastAcked"]==last_acked]
    # matching_rows_version= matching_rows_acked[matching_rows_acked["nonReportableData.isLatestVersion"]==lat_version]
    
       
    for index_b,row_b in matching_rows_trade_version.iterrows():
        golden.at[index_b,"Test Case"] = row_a["TestCase_name"]
        golden.at[index_b, "JIRA ID"] = row_a["Jira_ID"]
       
        
golden.to_csv('updated_file_golden2.csv',index=False)
print(count)
